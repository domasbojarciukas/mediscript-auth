<!doctype html>
<html>
  <head><meta charset="utf-8" /><title>Auth redirectâ€¦</title></head>
  <body>
    <script>
      const STREAMLIT_APP_URL = "https://mediscript.streamlit.app"; // <-- your app

      const hash = window.location.hash.startsWith("#") ? window.location.hash.slice(1) : "";
      const params = new URLSearchParams(hash);

      const access_token = params.get("access_token");
      const refresh_token = params.get("refresh_token");
      const state = params.get("state");
      const error = params.get("error_description") || params.get("error");

      const url = new URL(STREAMLIT_APP_URL);

      if (state) url.searchParams.set("state", state);

      if (error) {
        url.searchParams.set("error", error);
      } else if (access_token && refresh_token) {
        url.searchParams.set("access_token", access_token);
        url.searchParams.set("refresh_token", refresh_token);
      } else {
        url.searchParams.set("error", "missing_tokens_from_oauth_redirect");
      }

      window.location.replace(url.toString());
    </script>
  </body>
</html>
